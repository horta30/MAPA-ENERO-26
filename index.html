<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Mapa interactivo de senderos MTB en el Bosque Abierto, Chile. Descubre rutas de XC y DH con navegaciÃ³n GPS y descarga para Strava." />
  <meta name="keywords" content="MTB, mountain bike, Arauco, Chile, senderos, trails, XC, DH, ciclismo, bosque abierto, GPS, Strava" />
  <title>Bosque Abierto MTB V19 | 23 Rutas con NavegaciÃ³n GPS</title>

  <!-- MapLibre GL JS -->
  <link href="https://unpkg.com/maplibre-gl@4/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@4/dist/maplibre-gl.js"></script>

  <!-- JSZip para leer archivos KMZ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <!-- Estilos -->
  <link rel="stylesheet" href="css/styles.css" />

  <!-- Preload fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
  <div id="app">
    <!-- Mapa -->
    <div id="map" role="application" aria-label="Mapa interactivo de senderos MTB"></div>

    <!-- BotÃ³n flotante mÃ³vil -->
    <button 
      id="mobile-menu-trigger" 
      class="mobile-menu-trigger"
      aria-label="Abrir menÃº de rutas"
    >
      <span class="menu-icon">â˜°</span>
      <span class="menu-text">Ver Rutas MTB</span>
      <span class="menu-badge">23</span>
    </button>
    
    <!-- Hint para desplegar menÃº -->
    <div id="menu-hint" class="menu-hint">
      ğŸ‘‡ Â¡Despliega el menÃº de pistas!
    </div>

    <!-- BotÃ³n flotante de compartir general -->
    <button 
      id="share-general-btn" 
      class="share-general-btn"
      aria-label="Compartir mapa en redes sociales"
      title="Compartir mapa"
    >
      <span class="share-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
          <polyline points="16 6 12 2 8 6"/>
          <line x1="12" y1="2" x2="12" y2="15"/>
        </svg>
      </span>
    </button>

    <!-- MenÃº de compartir general -->
    <div id="share-general-menu" class="share-menu hidden">
      <div class="share-menu-header">Compartir Mapa</div>
      <button class="share-option" data-platform="whatsapp">
        <span class="share-platform-icon">ğŸ’¬</span> WhatsApp
      </button>
      <button class="share-option" data-platform="instagram">
        <span class="share-platform-icon">ğŸ“·</span> Instagram
      </button>
      <button class="share-option" data-platform="twitter">
        <span class="share-platform-icon">âœ•</span> X
      </button>
      <button class="share-option" data-platform="copy">
        <span class="share-platform-icon">ğŸ”—</span> Copiar Link
      </button>
    </div>

    <!-- Panel Lateral -->
    <aside id="panel" class="panel minimized" role="complementary" aria-label="Panel de informaciÃ³n de rutas">
      <button 
        id="panel-toggle" 
        class="panel-toggle" 
        aria-label="Minimizar o expandir panel"
        aria-expanded="false"
      >
        Rutas MTB
      </button>

      <div class="panel-inner">
        <!-- Header -->
        <header class="panel-header">
          <h1>Bosque Abierto MTB</h1>
          <p id="ruta-count" class="panel-subtitle" role="status" aria-live="polite">
            Cargando rutas...
          </p>
        </header>

        <!-- Leyenda mÃ­nima en lÃ­nea -->
        <div class="legend-inline">
          <span class="legend-item-inline"><span class="legend-icon xc">â– </span> XC</span>
          <span class="legend-separator">/</span>
          <span class="legend-item-inline"><span class="legend-icon dh">â—†â—†</span> DH</span>
          <span class="legend-separator">/</span>
          <span class="legend-item-inline"><span class="legend-icon bikepark">â—</span> BIKE PARK</span>
        </div>

        <!-- Lista de Rutas -->
        <section 
          id="rutas-list" 
          class="rutas-list" 
          role="list" 
          aria-label="Lista de rutas disponibles"
        >
        </section>
      </div>
    </aside>

    <!-- BotÃ³n Flotante de Enfoque -->
    <button 
      id="focus-toggle" 
      class="focus-toggle hidden" 
      aria-label="Alternar vista de ruta enfocada"
    >
      <span aria-hidden="true">ğŸ”</span>
      Ver solo esta ruta
    </button>

    <!-- Welcome overlay mÃ³vil -->
    <div id="welcome-overlay" class="welcome-overlay">
      <div class="welcome-content">
        <h2>ğŸšµ Explora el Bosque Abierto</h2>
        <p>Toca los puntos verdes para ver cada ruta y navegar hasta ella con Google Maps o Waze</p>
        <button id="welcome-close" class="welcome-close">Comenzar</button>
      </div>
    </div>

    <!-- Hint flotante de interacciÃ³n -->
    <div id="interaction-hint" class="interaction-hint">
      <span class="hint-icon">ğŸ‘†</span>
      <span class="hint-text">Haz click en cualquier punto verde</span>
    </div>
  </div>

  <!-- Scripts -->
  <script src="data/trails.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
